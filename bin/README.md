# Usage instructions

### Estimation of vulnerability indices

```bash
./Vulnerability_script.R \
  --input "Vuln_inp_data__Pathogen.RData" \
  --env "Altitude" \
  --transf "none"
```

Input file (`-i` or `--input` arguments) should be a serialized R list (saved with `saveRDS(...)`) with two slots:
- `sp` = OTU table (class `data.table`) with samples by rows and OTUs by columns;
- `env` = environmental data for samples (class `data.table`) with multiple columns, including sample name (`SampleID_Endemism`), sample type (`Sample_type`), ecoregion (`Ecoregion`), geographic coordinates (`Long`, `Lat`), variable of interest (e.g., land cover change), and cell number from the corresponding raster (`CellID`);


Argument `--env` (or `-e`) specifies the variable name from the environmental data.

The variable transformation could be specified with `--transf` (or `-t`) argument. Available options:
- `none` = no transformation (default)
- `log` = *log2(x + 1)*
- `symlog` = symmetrical log = *sign(x) * log2(abs(x) + 1)*
- `asinh` = negative of inverse hyperbolic sine = *-1 * asinh(x)*
- `inv` = inverse = *-1 * x*
- `symsqrt` = symmetrical square root = *sign(x) * sqrt(abs(x))*


### Vulnerability model fitting and spatial prediction

```bash
./Vulnerability_script_map.R \
  --input "Inds__primary_lifestyle_ectomycorrhizal__MAP" \
  --tiff "CHELSA_bio12_1981-2010_V.2.1.tif" \
  --suff "_Current" \
  --transf "log" \
  --model "gam"
```

### Estimation of the diversity residuals

```bash
./Diversity_residuals.R \
  --data "FOR_PREDICTION.xlsx" \
  --sheet "GSMc" \
  --var "RES_LOG_ectomycorrhizal_Richness" \
  --raster "ECM__LT_LinearModel.tif" \
  --grid "Grid_1.RData" \
  --idwpower 2
```
Higher power value (`--idwpower` parameter) puts more emphasis on the nearest points.
Thus, nearby data will have the most influence, and the surface will have more detail (be less smooth).
Specifying a lower value for power will give more influence to surrounding points that are farther away, resulting in a smoother surface.
